/*
 * Copyright (C) 2009-2023 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.controller("i2d.eam.workpermit.manages1.ext.controller.ListReportExt",{onApplicationLogsPress:function(){this.extensionAPI.getNavigationController().navigateExternal("ApplicationLog",{LogObjectId:"LOG_WCM_ML"});},onBeforeRebindTableExtension:function(e){var b=e.getParameter("bindingParams");var s=b&&b.parameters.select;if(s.includes("ActiveMaintenanceOrder")&&!s.includes("NumberOfOrders")){b.parameters.select+=",NumberOfOrders";}},formatOrderColumnExt:function(n){var i=this.getView().getModel("i18n");var a=i.getResourceBundle().getText("xlnk.assigned");return a+"("+n+") ";},onOrderColumnLinkPress:function(e){var s=e.getSource();if(!this._oOrderListPopover){sap.ui.core.Fragment.load({id:"idOrderListFragment",name:"i2d.eam.workpermit.manages1.ext.view.fragments.OrderListPopover",controller:this}).then(function(p){this._oOrderListPopover=p;this.getView().addDependent(this._oOrderListPopover);var t=s.getBindingContext().getProperty("/WorkPermit/ActiveMaintenanceOrder/#@sap:label");p.setModel(new sap.ui.model.json.JSONModel({title:t}),"assignedOrderList");this._setOrderListData(p,s);this._oOrderListPopover.openBy(s);}.bind(this));}else{this._setOrderListData(this._oOrderListPopover,s);this._oOrderListPopover.openBy(s);}},_setOrderListData:function(p,s){p.setBusy(true);var P=s.getBindingContext().getPath()+"/to_WorkPermitOrder";var a=p.getModel("assignedOrderList");a.setProperty("/data",[]);this.getView().getModel().read(P,{urlParameters:{"$select":"MaintenanceOrder,MaintenanceOrderDesc","$orderby":"MaintenanceOrder"},success:function(d){a.setProperty("/data",d.results);p.setBusy(false);},error:function(){p.setBusy(false);}});},formatMaintOrderListExt:function(m,M){return m+" ("+M+") ";},onNavOrderPress:function(e){var b=e.getSource().getBindingContext("assignedOrderList");var m=b.getProperty("MaintenanceOrder");var n=this.extensionAPI.getNavigationController();if(n&&m){n.navigateExternal("MaintenanceOrderDisplay",{"MaintenanceOrder":m});}}});
